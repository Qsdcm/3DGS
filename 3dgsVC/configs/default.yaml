# =============================================================================
# 3DGSMR: 3D Gaussian Representation for MRI Reconstruction
# Default Configuration File
# =============================================================================

# Data Configuration
data:
  data_path: "/data/data54/wanghaobo/data/ksp_full.h5"
  # 加速因子 (2, 3, 4, 6, 8)
  acceleration_factor: 4
  # 欠采样mask类型: "gaussian", "poisson", "random"
  mask_type: "gaussian"
  # 是否使用ACS (Auto-Calibration Signal) 区域
  use_acs: true
  acs_lines: 32  # ACS区域的线数

# Gaussian Model Configuration
gaussian:
  # 初始Gaussian点数 (论文中使用500用于高加速因子)
  initial_num_points: 500
  # 最大Gaussian点数 (用于densification)
  max_num_points: 50000  # 简化版本,论文中用400k-800k
  # 初始尺度因子
  initial_scale: 2.0
  # 位置学习率
  position_lr: 0.001
  # 尺度学习率  
  scale_lr: 0.005
  # 旋转学习率
  rotation_lr: 0.001
  # 密度学习率
  density_lr: 0.01
  # 是否使用复数密度值 (MRI为复值)
  complex_density: true

# Adaptive Control (Densification) Configuration
adaptive_control:
  # 是否启用densification
  enable: true
  # 开始densification的迭代次数
  densify_from_iter: 100
  # 每隔多少iter进行一次densification
  densify_every: 50
  # 停止densification的迭代次数
  densify_until_iter: 1000
  # 梯度阈值用于判断是否需要densify
  grad_threshold: 0.0002
  # 使用long-axis splitting策略 (论文中用于高加速因子)
  use_long_axis_splitting: true
  # long-axis splitting的尺度阈值
  scale_threshold: 0.01
  # 是否使用cloning (论文中高加速因子时禁用)
  use_cloning: false
  # 最小不透明度阈值 (低于此值的点会被剪除)
  opacity_threshold: 0.01

# Training Configuration
training:
  # 最大迭代次数
  max_iterations: 2000
  # 保存checkpoint的间隔
  save_every: 500
  # 日志打印间隔
  log_every: 50
  # 评估间隔 (计算PSNR/SSIM)
  eval_every: 100
  # 学习率调度器
  lr_scheduler:
    type: "exponential"  # "step", "exponential", "cosine"
    gamma: 0.95
    step_size: 200
  # 随机种子
  seed: 42

# Loss Configuration
loss:
  # k-space域loss权重
  kspace_weight: 1.0
  # image域loss权重
  image_weight: 0.1
  # TV正则化权重 (论文中发现对MRI影响有限,可设为0)
  tv_weight: 0.0
  # L1 vs L2 loss
  loss_type: "l2"  # "l1" or "l2"

# Output Configuration
output:
  # 输出目录
  output_dir: "./outputs"
  # 实验名称
  exp_name: "3dgsmr_exp"
  # 是否保存重建结果为nii
  save_nii: true
  # 是否保存为npy
  save_npy: true
  # TensorBoard日志
  use_tensorboard: true

# Hardware Configuration
hardware:
  # GPU设备ID
  device: "cuda:2"
  # 混合精度训练
  use_amp: false  # MRI复值计算时需谨慎使用
  # 数据加载线程数
  num_workers: 16
